<%= render :partial => 'shared/users/sections' %>
<% @details = current_user.details %>
<% content_for(:head) do %>
  <%= stylesheet_link_tag "jcrop.css" %>
  <%= javascript_include_tag "jcrop.js" %>
<% end %>


<%= form_for @details, :html => {:method => :put, :multipart => true} do |f| %>
  <% if @details.avatar.exists? %>
    <%= image_tag @details.avatar.url(:large), 'data-geometry' => @details.avatar.dimensions(:large).to_s,
              'data-ratio' => @details.avatar.ratio(:original, :large), :id => :cropbox %>
  <h4>Preview</h4>
  <div id='avatar-preview'>
    <%= (image_tag @details.avatar.url(:large), :id => :preview)  %>
  </div>
  <% for attribute in [:crop_x, :crop_y, :crop_w, :crop_h] %>
    <%= f.hidden_field attribute, :id => attribute %>
  <% end %>
<% end %>
  <div class="row">
    <%= f.label(t :avatar) %> <%= f.file_field :avatar %>
  </div>
  <%= f.submit(t :renew_avatar) %>
<% end %>
<strong> Current avatar: </strong><%= image_tag @details.avatar.url(:small) if @details.avatar.exists?%>
